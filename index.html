<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>富台指數與台指期換算器</title>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .converter-box {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        label {
            font-weight: bold;
            color: #555;
        }
        input {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e9;
            border-radius: 5px;
            text-align: center;
            font-size: 18px;
        }
        .last-update {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }
        .auto-update {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 14px;
        }
        .status.active {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        .status.inactive {
            background-color: #ffebee;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>富台指數與台指期換算器</h1>
        <div class="converter-box">
            <div class="input-group">
                <label for="ftse">富台指數價格：</label>
                <input type="number" id="ftse" placeholder="請輸入富台指數價格" step="0.01">
            </div>
            <div class="input-group">
                <label for="tx">台指期價格：</label>
                <input type="number" id="tx" placeholder="請輸入台指期價格" step="0.01">
            </div>
            <div class="result" id="result"></div>
            <div class="last-update" id="lastUpdate"></div>
            <div class="auto-update">
                <button id="toggleAutoUpdate">開啟自動更新</button>
                <span id="updateStatus" class="status inactive">自動更新已關閉</span>
            </div>
        </div>
    </div>

    <script>
        // 換算比例（1富台指數 = 2台指期）
        const CONVERSION_RATE = 2;
        let autoUpdateInterval = null;
        let isAutoUpdateActive = false;

        // 模擬獲取富台指數數據
        async function fetchFTSEPrice() {
            try {
                // 這裡應該替換成實際的API調用
                // 目前使用模擬數據
                const basePrice = 17000; // 基準價格
                const randomChange = (Math.random() - 0.5) * 100; // 隨機波動
                return basePrice + randomChange;
            } catch (error) {
                console.error('獲取富台指數數據失敗:', error);
                return null;
            }
        }

        function updateConversion() {
            const ftseInput = document.getElementById('ftse');
            const txInput = document.getElementById('tx');
            const resultDiv = document.getElementById('result');
            const lastUpdateDiv = document.getElementById('lastUpdate');

            // 更新最後更新時間
            const now = new Date();
            lastUpdateDiv.textContent = `最後更新時間：${now.toLocaleString()}`;

            // 如果兩個輸入框都有值，計算價差
            if (ftseInput.value && txInput.value) {
                const ftse = parseFloat(ftseInput.value);
                const tx = parseFloat(txInput.value);
                const expectedTx = ftse / CONVERSION_RATE;
                const difference = tx - expectedTx;
                const percentage = (difference / expectedTx) * 100;

                resultDiv.innerHTML = `
                    <strong>換算結果：</strong><br>
                    預期台指期價格：${expectedTx.toFixed(2)}<br>
                    實際價差：${difference.toFixed(2)}<br>
                    價差百分比：${percentage.toFixed(2)}%
                `;
            }
        }

        async function autoUpdate() {
            if (!isAutoUpdateActive) return;
            
            const ftsePrice = await fetchFTSEPrice();
            if (ftsePrice) {
                document.getElementById('ftse').value = ftsePrice.toFixed(2);
                updateConversion();
            }
        }

        function toggleAutoUpdate() {
            const button = document.getElementById('toggleAutoUpdate');
            const status = document.getElementById('updateStatus');
            
            if (!isAutoUpdateActive) {
                // 開啟自動更新
                isAutoUpdateActive = true;
                button.textContent = '關閉自動更新';
                status.textContent = '自動更新已開啟';
                status.className = 'status active';
                
                // 立即執行一次
                autoUpdate();
                
                // 設置定時器
                autoUpdateInterval = setInterval(autoUpdate, 10000);
            } else {
                // 關閉自動更新
                isAutoUpdateActive = false;
                button.textContent = '開啟自動更新';
                status.textContent = '自動更新已關閉';
                status.className = 'status inactive';
                
                if (autoUpdateInterval) {
                    clearInterval(autoUpdateInterval);
                    autoUpdateInterval = null;
                }
            }
        }

        // 監聽輸入變化
        document.getElementById('ftse').addEventListener('input', updateConversion);
        document.getElementById('tx').addEventListener('input', updateConversion);
        document.getElementById('toggleAutoUpdate').addEventListener('click', toggleAutoUpdate);

        // 初始更新
        updateConversion();
    </script>
</body>
</html> 
